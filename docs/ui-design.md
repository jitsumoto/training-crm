# 画面設計ドキュメント

Training CRM の主な画面について、現状実装済みの UI と、今後追加予定のページ構成を整理します。各画面の URL、役割、主要コンポーネント、ユーザ操作を明確化し、Thymeleaf のテンプレート実装に落とし込む際の指針とします。

---

## 1. 学生モジュール (既存)

### 1.1 学生一覧 (`/students/list`)

```
+-----------------------------------------------------------------------------------+
| [タイトル] 学生一覧                                                               |
|-----------------------------------------------------------------------------------|
| [ボタン] 新規登録                                                                |
|-----------------------------------------------------------------------------------|
|  ID | 名前 | Email | 電話番号 | クラス | [編集] [削除] [成績一覧]                |
|-----------------------------------------------------------------------------------|
|  1  | 佐藤花子 | ... | ... | ... | [編集] [削除] [成績一覧]                     |
| ...                                                                               |
+-----------------------------------------------------------------------------------+
```

- **目的**: 登録済み学生の一覧表示と、編集・削除・成績参照への導線を提供。
- **主要要素**
  - 一覧テーブル (Thymeleaf `th:each`)
  - 行動リンク: `編集` → `/students/edit/{id}`、`削除` → `/students/delete/{id}`、`成績一覧` → `/students/{id}/records/list`
  - 上部に `新規登録` ボタン → `/students/new`
- **改善メモ**
  - 検索/絞り込み、ページング、ソートを追加予定。
  - 表示カラムの整理（メールリンク化、電話番号フォーマットなど）。

### 1.2 学生登録/編集 (`/students/new`, `/students/edit/{id}`)

```
+-----------------------------------------------+
| [タイトル] 新規学生登録 / 学生編集            |
|-----------------------------------------------|
| 名前      [                ]                  |
| Email     [                ]                  |
| 電話      [                ]                  |
| クラス    [                ]                  |
|-----------------------------------------------|
| [保存]                                      [戻る] |
+-----------------------------------------------+
```

- **目的**: 学生情報の新規登録・更新を行うフォームを提供。
- **主要要素**
  - 入力フォーム (`th:object="${student}"`)
  - `保存` ボタン → POST `/students/save`
  - `戻る` リンク → `/students/list`
- **改善メモ**
  - 入力バリデーションとエラー表示 (`th:errors`) を追加。
  - 電話番号・メールアドレスの入力補助 (placeholder, pattern) を検討。

### 1.3 成績一覧 (`/students/{studentId}/records/list`)

```
+--------------------------------------------------------------------------------+
| [タイトル] {学生名} の成績一覧                                                 |
|--------------------------------------------------------------------------------|
| [リンク] ← 学生一覧へ戻る  |  [ボタン] 新しい成績を追加                       |
|--------------------------------------------------------------------------------|
|  日付  | レベル | スコア | [編集] [削除]                                       |
|--------------------------------------------------------------------------------|
| 2024-03-10 | 2級 | 81 | [編集] [削除]                                         |
| ...                                                                              |
+--------------------------------------------------------------------------------+
```

- **目的**: 指定学生に紐づく成績 `records` の一覧を表示。編集/削除/追加を行う。
- **主要要素**
  - 上部に学生情報 (氏名、クラス等) の表示を追加予定。
  - 行内の操作リンク: `編集` → `/students/{studentId}/records/edit/{recordId}`、`削除` → `/students/{studentId}/records/delete/{recordId}`。
- **改善メモ**
  - スコア推移をグラフ化するミニチャートの表示検討。
  - 合否表示（`result`）追加後の UI 調整。

### 1.4 成績登録/編集 (`/students/{studentId}/records/new`, `/edit/{recordId}`)

```
+--------------------------------------------------+
| [タイトル] 成績フォーム                            |
|--------------------------------------------------|
| 日付      [     date picker     ]                |
| レベル    [                     ]                |
| スコア    [         0〜100       ]               |
|--------------------------------------------------|
| [保存]                                         [一覧へ戻る] |
+--------------------------------------------------+
```

- **目的**: 学生の成績を登録/更新するフォームを提供。
- **主要要素**
  - 隠しフィールドで `recordId` を保持 (`th:field="*{recordId}"`)
  - `保存` ボタン → POST `/students/{studentId}/records/save`
- **改善メモ**
  - `result` (合否) や `memo` フィールドを追加した際の UI 拡張。
  - 入力値のバリデーションとエラー表示を整備。

---

## 2. 案件モジュール (拡張予定)

### 2.1 案件一覧 (`/projects`)

```
+----------------------------------------------------------------------------------+
| [タイトル] 案件一覧                                                                |
|----------------------------------------------------------------------------------|
| [フィルタ] ステータス: [PLANNING▼] [検索]  [ボタン] 新規案件                       |
|----------------------------------------------------------------------------------|
| 名称 | 自治体名 | ステータス | 期間 | 金額 | 進捗率 | [詳細] [編集] [削除]        |
|----------------------------------------------------------------------------------|
| ...                                                                              |
+----------------------------------------------------------------------------------+
```

- **目的**: 案件の全体状況を把握し、詳細・編集・削除操作へ遷移。
- **主要要素**
  - ステータスフィルタ、検索フォーム。
  - 進捗率・期間の表示 (start/end date)。
  - 詳細ページへのリンクでタスク・活動一覧を表示予定。

### 2.2 案件詳細 (`/projects/{projectId}`)

```
+----------------------------------------------------+
| 案件概要                                           |
|----------------------------------------------------|
| 名称: 〇〇スクール                                 |
| 自治体: △△市                                      |
| 期間: 2024-04-01 〜 2025-03-31                     |
| ステータス: IN_PROGRESS                            |
| 金額: ¥12,000,000                                  |
| [編集] [削除]                                      |
+----------------------------------------------------+
| タスク一覧                                         |
|----------------------------------------------------|
| [ボタン] タスク追加                                |
|  タイトル | 担当者 | 期限 | ステータス | 進捗 | [詳細] |
+----------------------------------------------------+
| 活動ログ                                          |
|----------------------------------------------------|
| [ボタン] 活動登録                                  |
|  日時 | 種別 | 担当者 | メモ                         |
+----------------------------------------------------+
```

- **目的**: 案件情報を概観し、関連タスク・活動を管理する。
- **主要要素**
  - 上段で案件概要のカード表示。
  - タスクと活動ログをタブ/セクションで表示。
  - グラフ（進捗、件数）を右側や下部に配置する余地。

### 2.3 タスク登録/編集 (`/projects/{projectId}/tasks/new`)

- **入力項目**: タイトル、担当者 (USERS 選択)、期限、ステータス、進捗率、詳細メモ。
- **UI**: プルダウンで担当者、ステータス / 進捗率はスライダーや入力欄。
- **遷移**: 保存後は案件詳細へ戻る。

### 2.4 活動ログ登録 (`/projects/{projectId}/tasks/{taskId}/activities/new`)

- **入力項目**: 活動日時、活動種別 (会議/訪問/電話等)、場所、記録メモ。
- **UI**: 日時ピッカー、種別は選択式、メモはテキストエリア。
- **遷移**: 保存後はタスク詳細または案件詳細の活動セクションへ戻る。

---

## 3. ユーザ/認証モジュール (拡張予定)

### 3.1 ログイン画面 (`/login`)

```
+---------------------------+
| Training CRM ログイン     |
|---------------------------|
| ユーザ名 [             ]  |
| パスワード [***********]  |
| [ログイン]                |
|---------------------------|
| [パスワードをお忘れの方へ]|
+---------------------------+
```

- Spring Security を有効化する際の標準フォーム。
- 成功時はダッシュボードへ遷移、失敗時はエラーメッセージ表示。

### 3.2 ダッシュボード (`/dashboard`)

- **ウィジェット例**
  - 生徒数・合格率などの KPI カード
  - 成績推移チャート (学生別 / 全体)
  - 案件ステータス別の円グラフ
  - 今日のタスク / 期限超過タスク一覧

---

## 4. 画面遷移概要

```
[ログイン] → [ダッシュボード]
          ↘
           → [学生一覧] → [学生フォーム]
                      ↘
                       → [成績一覧] → [成績フォーム]

[ダッシュボード] → [案件一覧] → [案件詳細] → [タスクフォーム]
                                     ↘
                                      → [活動ログフォーム]
```

- ログイン後はダッシュボードをハブとし、学生モジュール・案件モジュール双方へ移動。
- 各モジュール内で CRUD 操作が完結する導線を確保。

---

## 5. デザイン指針メモ

- レイアウト: 基本は 1 カラム構成、将来的に共通ヘッダー/サイドメニューを導入。
- テーブル: Bootstrap 等の UI ライブラリ導入で視認性を向上検討。
- バリデーション: Bean Validation (`@NotBlank` 等) とフロント側の両面で実装。
- 国際化: メッセージ定義 (`messages.properties`) を整備し多言語化を視野に入れる。
- アクセシビリティ: ラベル関連付け、エラーメッセージの明示などを考慮。

この設計を基に、Thymeleaf テンプレートおよび REST API の UI 層を整えていきます。
